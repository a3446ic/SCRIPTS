--CREAR UNA TABLA TIPO COLUMNAS (USAR ESTE, MAYOR RENDIMIENTO)
CREATE COLUMN TABLE EXT.NOMBRE_TABLA(
	PERIODSEQ BIGINT CS_FIXED NOT NULL,
	CREDITSEQ BIGINT CS_FIXED NOT NULL,
	POSITIONSEQ BIGINT CS_FIXED NOT NULL
)
UNLOAD PRIORITY 5 AUTO MERGE;

--BORRAR UNA TABLA
DROP TABLE EXT.NOMBRE_TABLA


--CREAR UNA TABLA A PARTIR DE OTRA COMPROBANDO SI EXISTE
IF (SELECT TABLE_NAME FROM SYS.TABLES where SCHEMA_NAME='EXT' and TABLE_NAME like ('%NOMBRE_TABLA_BKP_' || TO_VARCHAR(CURRENT_DATE, 'YYYYMMDD'))) IS NULL THEN
	EXEC('CREATE COLUMN TABLE EXT.NOMBRE_TABLA_BKP_' || TO_VARCHAR(CURRENT_DATE, 'YYYYMMDD') || ' AS (SELECT * FROM EXT.NOMBRE_TABLA)');
    CALL LIB_GLOBAL_CESCE :w_debug (
        i_Tenant,
        'Creado BackUp EXT.NOMBRE_TABLA_BKP_' || TO_VARCHAR(CURRENT_DATE, 'YYYYMMDD'),
        cReportTable,
        io_contador
    );
END IF;

--AÃ‘ADIR COLUMNA A UN TABLA
ALTER TABLE EXT.NOMBRE_TABLA ADD(ID INT);

--BORRAR COLUMNA A UNA TABLA
ALTER TABLE EXT.NOMBRE_TABLA DROP(ID);

--CAMBIAR NOMBRE COLUMNA
RENAME COLUMN EXT.NOMBRE_TABLA.ID TO IDDOC;

--INSERTAR UNA TABLA A PARTIR DE UNA SELECT (TIENEN QUE TENER LOS MISMOS CAMPOS)
INSERT INTO EXT.TABLA_DESTINO
SELECT * FROM EXT.TABLA_ORIGEN

--CAMPO INCREMENTAL
"ID" BIGINT CS_FIXED NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1),